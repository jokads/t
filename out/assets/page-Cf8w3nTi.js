import{j as e}from"./index-CL0DDCgk.js";import{b as a}from"./vendor-CnxkC70x.js";import{checkBackendHealth as J,apiGet as d}from"./api-D2Re7A7a.js";function Y(){const[n,u]=a.useState("checking"),[P,y]=a.useState({frontend:!0,backend:!1,pythonCore:!1,mt5Socket:!1,basePath:"",modelsPath:"",aiModelsCount:0}),[E,j]=a.useState([]),[i,x]=a.useState([]),[p,v]=a.useState([]),[N,b]=a.useState([]),[U,w]=a.useState([]),[m,F]=a.useState("logs"),[h,o]=a.useState(!1),[g,f]=a.useState(!1),[T,S]=a.useState(""),[k,G]=a.useState(null),[r,A]=a.useState(null);a.useEffect(()=>{_();const s=setInterval(()=>{n==="connected"&&(I(),C(),$())},15e3);return()=>clearInterval(s)},[n]);const _=async()=>{u("checking"),await J()?(u("connected"),await Promise.all([O(),M(),I(),C(),$()])):(u("offline"),y(t=>({...t,backend:!1})),D(),B(),L(),M())},O=async()=>{try{const s=await d("/api/diagnostics/project_info");s&&!s.error&&y({frontend:!0,backend:s.dashboard_status?.active??!1,pythonCore:s.bot_connected??!1,mt5Socket:s.mt5_socket?.connected??!1,basePath:s.base_path??"",modelsPath:s.models_path??"",aiModelsCount:s.ai_models?.length??0})}catch{console.warn("Falha ao obter info de ambiente ‚Äì fallback ativo")}},M=async()=>{try{const t=await d("/api/diagnostics/project_info");if(t?.ai_models?.length){const c=t.ai_models.map((l,z)=>({id:l.id??`model-${z}`,name:l.name??`Modelo ${z+1}`,path:l.path??"",type:l.type??"gpt4all",size:l.size_mb?`${l.size_mb} MB`:"Desconhecido",status:(l.loaded,"available")}));j(c),i.length||x(c.slice(0,2).map(l=>l.id));return}}catch{}j([{id:"llama-3.2-3b",name:"Llama 3.2 3B",path:"",type:"gpt4all",size:"2.0 GB",status:"available"},{id:"nous-hermes",name:"Nous Hermes 2 Mistral 7B",path:"",type:"gpt4all",size:"4.1 GB",status:"available"},{id:"llama-3.2-1b",name:"Llama 3.2 1B",path:"",type:"gpt4all",size:"1.2 GB",status:"available"},{id:"phi-3-mini",name:"Phi-3 Mini 4K",path:"",type:"gpt4all",size:"2.3 GB",status:"available"},{id:"orca-mini",name:"Orca Mini 3B",path:"",type:"gpt4all",size:"1.8 GB",status:"available"},{id:"qwen2-1.5b",name:"Qwen2 1.5B",path:"",type:"gpt4all",size:"1.0 GB",status:"available"}]),i.length||x(["llama-3.2-3b","nous-hermes"])},I=async()=>{try{const s=await d("/api/audit/logs");if(Array.isArray(s)){v(s);return}}catch{}D()},C=async()=>{try{const s=await d("/api/audit/snapshots");if(Array.isArray(s)){b(s);return}}catch{}B()},$=async()=>{try{const s=await d("/api/audit/audits");if(Array.isArray(s)){w(s);return}}catch{}L()},D=()=>{const s=Date.now(),t=[{id:"log-1",timestamp:new Date(s-5*6e4).toISOString(),level:"success",category:"Authentication",action:"Login bem‚Äësucedido",details:"Utilizador damasclaudio2@gmail.com autenticado",user:"system",ip:"127.0.0.1",resolved:!0},{id:"log-2",timestamp:new Date(s-15*6e4).toISOString(),level:"warning",category:"Risk Management",action:"Drawdown di√°rio atingiu 70%",details:"Perda atual: $700 de $1000 limite",user:"risk_manager",ip:"127.0.0.1",resolved:!1,aiAnalysis:{analyzed:!0,confidence:87,summary:"Situa√ß√£o requer aten√ß√£o. Recomenda‚Äëse reduzir tamanho de posi√ß√µes.",recommendations:["Reduzir alavancagem","Ajustar limites de risco"]}},{id:"log-3",timestamp:new Date(s-30*6e4).toISOString(),level:"info",category:"System",action:"Sistema iniciado em modo SAFE",details:"",user:"system",ip:"127.0.0.1",resolved:!0}];v(t)},B=()=>{const s=Date.now(),t=[{id:"snap-1",timestamp:new Date(s-2*36e5).toISOString(),type:"manual",creator:"damasclaudio2@gmail.com",description:"Snapshot antes de atualizar estrat√©gias",size:"2.4 MB",status:"completed",verified:!0,hash:`sha256:${Math.random().toString(36).substring(2,15)}`,state:{mode:"SAFE",emergency_stop:!1,active_trades:2,equity:10500,balance:1e4,daily_pnl:150,open_positions:[{symbol:"EURUSD",type:"BUY",lots:.1,profit:45},{symbol:"GBPUSD",type:"SELL",lots:.05,profit:-15}]}}];b(t)},L=()=>{const s=Date.now(),t=[{id:"audit-1",timestamp:new Date(s-36e5).toISOString(),type:"automated",status:"completed",findings:3,critical_count:0,risk_score:15,ai_analysis:"Sistema seguro. Nenhum problema cr√≠tico detectado."}];w(t)},R=s=>{x(t=>t.includes(s)?t.filter(c=>c!==s):[...t,s])},q=async()=>{if(!i.length){alert("Selecione ao menos um modelo IA antes de iniciar a auditoria.");return}if(n==="offline"){alert(`Backend offline ‚Äì auditoria simulada conclu√≠da.

‚úÖ 3 logs analisados
‚úÖ 1 snapshot verificado
Score: 95/100`);return}o(!0);try{await new Promise(t=>setTimeout(t,2e3));const s=`ü§ñ Auditoria completa com ${i.length} modelo(s)

üìä Logs analisados: ${p.length}
‚ö†Ô∏è Avisos: ${p.filter(t=>t.level==="warning").length}
‚ùå Erros: ${p.filter(t=>t.level==="critical").length}
üì¶ Snapshots verificados: ${N.length}
üõ°Ô∏è Score de integridade: 95/100`;S(s),f(!0)}finally{o(!1)}},H=async()=>{if(n==="offline"){alert("Backend offline ‚Äì snapshot simulado criado.");const s={id:Date.now().toString(),timestamp:new Date().toISOString(),type:"manual",creator:"damasclaudio2@gmail.com",description:"Snapshot manual criado via UI",size:"2.5 MB",status:"completed",verified:!0,hash:`sha256:${Math.random().toString(36).substring(2,15)}`,state:{mode:P.backend?"LIVE":"SAFE",emergency_stop:!1,active_trades:Math.floor(Math.random()*5),equity:1e4+Math.random()*2e3,balance:1e4,daily_pnl:(Math.random()-.5)*500,open_positions:[]}};b(t=>[s,...t]);return}o(!0);try{await new Promise(s=>setTimeout(s,1e3))}finally{o(!1)}},V=async s=>{if(!i.length){alert("Selecione ao menos um modelo IA antes de analisar.");return}G(s),f(!0),o(!0),await new Promise(c=>setTimeout(c,1500));const t=`ü§ñ An√°lise IA (${i.length} modelo(s))

üìä Log: ${s.action}
üîç N√≠vel: ${s.level}
‚ö†Ô∏è Avalia√ß√£o: ${s.level==="warning"?"Aten√ß√£o":s.level==="critical"?"Cr√≠tico":"Normal"}
üí° Recomenda√ß√µes: ${s.level==="critical"?"Interven√ß√£o imediata":"Monitorar"}
`;S(t),o(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-950 via-orange-950 to-purple-950 p-6 text-white",children:[e.jsxs("header",{className:"mb-6",children:[e.jsx("h1",{className:"text-4xl font-black gradient-text",children:"üõ°Ô∏è Centro de Auditoria Ultra‚ÄëHardcore"}),e.jsx("p",{className:"text-purple-300 mt-2",children:"üìã Logs, snapshots e an√°lise IA em tempo real"}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs("button",{onClick:q,disabled:h,className:"px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all shadow-lg shadow-purple-500/30 flex items-center gap-2 whitespace-nowrap disabled:opacity-50",children:[e.jsx("i",{className:"ri-robot-line mr-2"}),h?"Analisando...":"Auditoria IA"]}),e.jsxs("button",{onClick:H,disabled:h,className:"px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white rounded-lg font-medium transition-all shadow-lg shadow-green-500/30 flex items-center gap-2 whitespace-nowrap disabled:opacity-50",children:[e.jsx("i",{className:"ri-camera-line mr-2"}),h?"Criando...":"Criar Snapshot"]}),e.jsxs("button",{onClick:_,className:"px-6 py-3 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white rounded-lg font-medium transition-all shadow-lg shadow-orange-500/30 flex items-center gap-2 whitespace-nowrap",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Atualizar"]})]})]}),n==="checking"&&e.jsxs("div",{className:"p-4 mb-4 bg-yellow-500/10 border border-yellow-500/30 rounded-lg flex items-center gap-3",children:[e.jsx("i",{className:"ri-loader-4-line text-2xl text-yellow-400 animate-spin"}),e.jsx("span",{className:"text-yellow-400 font-semibold",children:"Verificando backend..."})]}),n==="offline"&&e.jsxs("div",{className:"p-4 mb-4 bg-orange-500/10 border border-orange-500/30 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-400 mb-2",children:"‚ö†Ô∏è Backend offline ‚Äì modo fallback"}),e.jsx("p",{className:"text-orange-300 mb-3",children:"Inicie o dashboard_server.py e trading_bot_core.py para dados reais."}),e.jsx("pre",{className:"bg-black/30 p-3 rounded text-sm text-orange-300 whitespace-pre-wrap",children:`cd C:\\bot-mt5
python -m backend.dashboard_server
python trading_bot_core.py`})]}),e.jsxs("section",{className:"mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold gradient-text mb-2",children:["ü§ñ Modelos IA Selecionados (",i.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:E.map(s=>e.jsx("label",{className:`p-4 rounded border cursor-pointer transition-all hover:scale-105 ${i.includes(s.id)?"bg-purple-500/20 border-purple-500":"bg-black/20 border-purple-500/30 hover:border-purple-500/60"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.includes(s.id),onChange:()=>R(s.id),className:"w-5 h-5 text-purple-600 bg-black/50 border-2 border-purple-500 rounded"}),e.jsx("span",{className:"font-medium text-purple-100",children:s.name}),e.jsx("span",{className:"text-xs text-purple-300",children:s.size})]})},s.id))}),i.length===0&&e.jsx("p",{className:"mt-2 text-orange-300 text-sm",children:"Selecione ao menos um modelo IA para habilitar an√°lises."})]}),e.jsx("nav",{className:"flex border-b border-purple-500/20 mb-4",children:["logs","snapshots","audit"].map(s=>e.jsxs("button",{onClick:()=>F(s),className:`px-6 py-3 font-medium transition-all whitespace-nowrap ${m===s?"text-orange-400 border-b-2 border-orange-400":"text-purple-300 hover:text-orange-300"}`,children:[s==="logs"&&e.jsx("i",{className:"ri-file-list-line mr-2"}),s==="snapshots"&&e.jsx("i",{className:"ri-camera-line mr-2"}),s==="audit"&&e.jsx("i",{className:"ri-shield-check-line mr-2"}),s.charAt(0).toUpperCase()+s.slice(1)]},s))}),e.jsxs("section",{children:[m==="logs"&&e.jsx("div",{className:"space-y-4",children:p.map(s=>e.jsxs("div",{className:"p-4 bg-black/30 rounded border border-purple-500/20 hover:border-orange-500/30 transition",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${s.level==="critical"?"bg-red-500/20 text-red-400":s.level==="warning"?"bg-yellow-500/20 text-yellow-400":s.level==="success"?"bg-green-500/20 text-green-400":"bg-blue-500/20 text-blue-400"}`,children:s.level.toUpperCase()}),e.jsx("span",{className:"text-sm text-purple-300",children:s.category})]}),e.jsx("span",{className:"text-xs text-purple-400",children:new Date(s.timestamp).toLocaleString("pt-PT")})]}),e.jsx("h3",{className:"text-lg font-semibold text-purple-100 mb-1",children:s.action}),s.details&&e.jsx("p",{className:"text-purple-300 mb-2",children:s.details}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-purple-500/10",children:[e.jsxs("div",{className:"text-sm text-purple-300",children:[e.jsx("i",{className:"ri-user-line mr-1"}),s.user,e.jsx("i",{className:"ri-global-line ml-4 mr-1"}),s.ip]}),e.jsxs("button",{onClick:()=>V(s),disabled:i.length===0,className:`px-3 py-1 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white rounded text-sm ${i.length===0?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("i",{className:"ri-robot-line mr-1"}),"IA"]})]})]},s.id))}),m==="snapshots"&&e.jsx("div",{className:"space-y-4",children:N.map(s=>e.jsxs("div",{className:"p-4 bg-black/30 rounded border border-purple-500/20 hover:border-cyan-500/30 transition",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-cyan-500/20 text-cyan-400",children:s.type.toUpperCase()}),e.jsx("span",{className:"text-xs text-purple-400",children:new Date(s.timestamp).toLocaleString("pt-PT")})]}),e.jsx("h3",{className:"text-lg font-semibold text-purple-100 mb-1",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mb-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-300",children:"Modo:"})," ",s.state.mode]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-300",children:"Trades:"})," ",s.state.active_trades]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-300",children:"Equity:"})," $",s.state.equity.toFixed(2)]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-300",children:"P&L Di√°rio:"})," $",s.state.daily_pnl.toFixed(2)]})]}),e.jsx("button",{onClick:()=>A(s),className:"px-3 py-1 bg-cyan-600 hover:bg-cyan-500 text-white rounded text-sm",children:"Ver detalhes"})]},s.id))}),m==="audit"&&e.jsx("div",{className:"space-y-4",children:U.map(s=>e.jsxs("div",{className:"p-4 bg-black/30 rounded border border-purple-500/20 hover:border-pink-500/30 transition",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-purple-500/20 text-purple-400",children:s.type.toUpperCase()}),e.jsx("span",{className:"text-xs text-purple-400",children:new Date(s.timestamp).toLocaleString("pt-PT")})]}),e.jsx("h3",{className:"text-lg font-semibold text-purple-100 mb-1",children:s.status.toUpperCase()}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-300",children:"Descobertas:"})," ",s.findings]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-300",children:"Cr√≠ticas:"})," ",s.critical_count]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-purple-300",children:"Score:"})," ",s.risk_score,"/100"]})]}),s.ai_analysis&&e.jsx("p",{className:"text-purple-300 text-sm",children:s.ai_analysis})]},s.id))})]}),(g||r)&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/90 to-red-900/90 rounded-xl border border-purple-500/30 p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold gradient-text",children:g?"ü§ñ An√°lise IA":"üì∏ Detalhes do Snapshot"}),e.jsx("button",{onClick:()=>{f(!1),A(null)},className:"w-10 h-10 flex items-center justify-center bg-red-600 hover:bg-red-500 text-white rounded-lg",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),g&&k&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-4 p-4 bg-black/30 rounded border border-purple-500/20",children:[e.jsxs("p",{className:"text-sm text-purple-300 mb-2",children:["Log: ",k.action]}),e.jsx("pre",{className:"text-purple-200 whitespace-pre-wrap",children:T})]})}),r&&e.jsxs("div",{className:"space-y-3 text-purple-200",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",r.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo:"})," ",r.type]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Descri√ß√£o:"})," ",r.description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Hash:"})," ",r.hash]}),e.jsx("pre",{className:"bg-black/20 p-2 rounded",children:JSON.stringify(r.state,null,2)})]})]})})]})}export{Y as default};
