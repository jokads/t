<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JokaMazKiBu Trading Bot - Dashboard Ultra Avançado</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/style.css">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Canvas para o efeito de triângulos de fundo -->
    <canvas id="triangle-canvas"></canvas>
    
    <div class="dashboard-container">
        <!-- ========== SIDEBAR ========== -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <img src="/static/img/logo.png" alt="Logo" class="logo-img">
                    <div class="logo-text">JOKAMAZKIBU</div>
                    <div class="version">v5.0 Ultra Advanced</div>
                </div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-item active" data-section="overview">
                    <a href="#" class="nav-link">
                        <i class="fas fa-chart-line"></i>
                        <span>Overview</span>
                        <span class="nav-badge">LIVE</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="trades">
                    <a href="#" class="nav-link">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Trades Ativos</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="history">
                    <a href="#" class="nav-link">
                        <i class="fas fa-history"></i>
                        <span>Histórico</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="strategies">
                    <a href="#" class="nav-link">
                        <i class="fas fa-brain"></i>
                        <span>Estratégias</span>
                        <span class="nav-badge" id="strategyCount">6</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="ai">
                    <a href="#" class="nav-link">
                        <i class="fas fa-robot"></i>
                        <span>IA & Análise</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="news">
                    <a href="#" class="nav-link">
                        <i class="fas fa-newspaper"></i>
                        <span>Notícias</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="mt4">
                    <a href="#" class="nav-link">
                        <i class="fas fa-plug"></i>
                        <span>Controlo MT4</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="system">
                    <a href="#" class="nav-link">
                        <i class="fas fa-cog"></i>
                        <span>Sistema</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="settings">
                    <a href="#" class="nav-link">
                        <i class="fas fa-sliders-h"></i>
                        <span>Configurações</span>
                    </a>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <a href="/logout" class="nav-link logout-link">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </div>
        </aside>
        
        <!-- ========== MAIN CONTENT ========== -->
        <main class="main-content" id="mainContent">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title" id="pageTitle">Overview</h1>
                </div>
                
                <div class="header-right">
                    <div class="status-indicator" id="mt4Status">
                        <span class="status-dot"></span>
                        <span id="mt4StatusText">MT4 OFFLINE</span>
                    </div>
                    
                    <div class="status-indicator online" id="botStatus">
                        <span class="status-dot"></span>
                        <span>BOT ATIVO</span>
                    </div>
                    
                    <div class="user-menu">
                        <div class="user-avatar">{{ session.get('username', 'J')[0].upper() }}</div>
                        <span>{{ session.get('username', 'Joka') }}</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </header>
            
            <!-- Content -->
            <div class="content">
                <!-- ========== OVERVIEW SECTION ========== -->
                <section class="content-section active" id="overview-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-chart-line text-gold"></i>
                        Visão Geral do Sistema
                    </h2>
                    
                    <!-- Stats Cards -->
                    <div class="grid grid-4 mb-3">
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="stat-label">Saldo Total</div>
                            <div class="stat-value" id="totalBalance">$0.00</div>
                            <div class="card-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span id="totalEquity">Equity: $0.00</span>
                            </div>
                        </div>
                        
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-label">Profit Total</div>
                            <div class="stat-value" id="totalProfit">$0.00</div>
                            <div class="card-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span id="profitTodayText">Profit Hoje: $0.00</span>
                            </div>
                        </div>
                        
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <div class="stat-label">Win Rate (Hoje)</div>
                            <div class="stat-value" id="winRate">0.0%</div>
                            <div class="card-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span id="totalTradesToday">0 trades</span>
                            </div>
                        </div>
                        
                        <div class="card stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <div class="stat-label">Trades Ativos</div>
                            <div class="stat-value" id="activeTradesCount">0</div>
                            <div class="card-change">
                                <i class="fas fa-circle"></i>
                                <span id="totalTrades">Total: 0</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts Row -->
                    <div class="grid grid-2 mb-3">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-chart-area"></i>
                                    Evolução do Saldo (Simulado)
                                </div>
                            </div>
                            <canvas id="balanceChart" height="300"></canvas>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-chart-pie"></i>
                                    Performance por Estratégia
                                </div>
                            </div>
                            <canvas id="strategyChart" height="300"></canvas>
                        </div>
                    </div>
                    
                    <!-- AI Consensus -->
                    <div class="card mb-3">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-robot"></i>
                                Consenso de IAs em Tempo Real
                            </div>
                        </div>
                        <div id="aiConsensusContainer" class="grid grid-3">
                            <!-- AI analyses will be loaded here via SocketIO -->
                            <div class="ai-card">
                                <div class="ai-name">Aguardando IAs...</div>
                                <div class="ai-specialty">Carregando modelos...</div>
                                <div class="ai-response">O sistema está inicializando os modelos de inteligência artificial.</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Signals -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-signal"></i>
                                Sinais Recentes
                            </div>
                        </div>
                        <div id="recentSignals" class="table-container">
                            <!-- Signals will be loaded here -->
                            <table class="signals-table">
                                <thead>
                                    <tr>
                                        <th>Símbolo</th>
                                        <th>Direção</th>
                                        <th>Confiança</th>
                                        <th>Estratégia</th>
                                        <th>Hora</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="5" class="text-center">Nenhum sinal recente.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <!-- ========== TRADES ATIVOS SECTION ========== -->
                <section class="content-section" id="trades-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-exchange-alt text-gold"></i>
                        Trades Ativos
                    </h2>
                    
                    <div class="card mb-3">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-list"></i>
                                Posições Abertas
                            </div>
                            <button class="btn btn-primary btn-sm">
                                <i class="fas fa-plus"></i>
                                Abrir Trade Manual
                            </button>
                        </div>
                        <div class="table-container">
                            <table id="activeTradesTable">
                                <thead>
                                    <tr>
                                        <th>Ticket</th>
                                        <th>Símbolo</th>
                                        <th>Tipo</th>
                                        <th>Volume</th>
                                        <th>Preço Entrada</th>
                                        <th>Preço Atual</th>
                                        <th>SL</th>
                                        <th>TP</th>
                                        <th>Profit</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="activeTradesBody">
                                    <tr><td colspan="10" class="text-center">Nenhuma posição aberta.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <!-- ========== HISTÓRICO SECTION ========== -->
                <section class="content-section" id="history-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-history text-gold"></i>
                        Histórico de Trades Fechados
                    </h2>
                    
                    <!-- Filters -->
                    <div class="card mb-3">
                        <div class="grid grid-4">
                            <div>
                                <label>Símbolo</label>
                                <select class="form-control" id="filterSymbol">
                                    <option value="">Todos</option>
                                </select>
                            </div>
                            <div>
                                <label>Estratégia</label>
                                <select class="form-control" id="filterStrategy">
                                    <option value="">Todas</option>
                                </select>
                            </div>
                            <div>
                                <label>Período</label>
                                <select class="form-control" id="filterPeriod">
                                    <option value="today">Hoje</option>
                                    <option value="week">Última Semana</option>
                                    <option value="month">Último Mês</option>
                                    <option value="all">Total</option>
                                </select>
                            </div>
                            <div>
                                <button class="btn btn-primary" style="margin-top: 24px;">
                                    <i class="fas fa-search"></i>
                                    Filtrar
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Trades Table -->
                    <div class="card">
                        <div class="table-container">
                            <table id="tradesHistoryTable">
                                <thead>
                                    <tr>
                                        <th>Ticket</th>
                                        <th>Símbolo</th>
                                        <th>Tipo</th>
                                        <th>Volume</th>
                                        <th>Entrada</th>
                                        <th>Saída</th>
                                        <th>Profit</th>
                                        <th>Estratégia</th>
                                        <th>Data Fecho</th>
                                    </tr>
                                </thead>
                                <tbody id="tradesHistoryBody">
                                    <tr><td colspan="9" class="text-center">Nenhum trade no histórico.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <!-- ========== STRATEGIES SECTION ========== -->
                <section class="content-section" id="strategies-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-brain text-gold"></i>
                        Gestão de Estratégias
                    </h2>
                    
                    <div class="grid grid-3" id="strategiesGrid">
                        <!-- Strategies will be loaded here -->
                    </div>
                </section>
                
                <!-- ========== AI SECTION ========== -->
                <section class="content-section" id="ai-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-robot text-gold"></i>
                        IA & Análise Avançada
                    </h2>
                    
                    <!-- AI Models -->
                    <div class="card mb-3">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-microchip"></i>
                                Modelos de IA Disponíveis
                            </div>
                        </div>
                        <div class="grid grid-3" id="aiModelsGrid">
                            <!-- AI models will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- AI Chat -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-comments"></i>
                                Chat com IA (Consenso)
                            </div>
                        </div>
                        <div id="aiChatMessages" style="height: 400px; overflow-y: auto; padding: 20px; background: var(--accent-bg); border-radius: 10px; margin-bottom: 20px;">
                            <!-- Messages will appear here -->
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <select id="aiChatModel" class="form-control" style="width: 150px;">
                                <option value="all">Consenso (Todos)</option>
                            </select>
                            <input type="text" id="aiChatInput" placeholder="Faça uma pergunta à IA..." style="flex: 1; padding: 12px; background: var(--accent-bg); border: 1px solid var(--border-color); border-radius: 10px; color: var(--text-primary);">
                            <button class="btn btn-primary" id="aiChatSend">
                                <i class="fas fa-paper-plane"></i>
                                Enviar
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- ========== NEWS SECTION ========== -->
                <section class="content-section" id="news-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-newspaper text-gold"></i>
                        Notícias de Mercado em Tempo Real
                    </h2>
                    
                    <div class="grid grid-2" id="newsGrid">
                        <!-- News will be loaded here -->
                    </div>
                </section>
                
                <!-- ========== MT4 SECTION ========== -->
                <section class="content-section" id="mt4-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-plug text-gold"></i>
                        Controlo MetaTrader 4
                    </h2>
                    
                    <div class="grid grid-3 mb-3">
                        <div class="card">
                            <div class="card-title mb-2">
                                <i class="fas fa-info-circle"></i>
                                Status de Conexão
                            </div>
                            <div class="stat-value" id="mt4Connected">Aguardando...</div>
                            <div class="text-muted mt-1">Latência: <span id="mt4Latency">--</span></div>
                        </div>
                        
                        <div class="card">
                            <div class="card-title mb-2">
                                <i class="fas fa-server"></i>
                                Servidor
                            </div>
                            <div class="stat-value" id="mt4Server">--</div>
                            <div class="text-muted mt-1">Conta: <span id="mt4Account">--</span></div>
                        </div>
                        
                        <div class="card">
                            <div class="card-title mb-2">
                                <i class="fas fa-clock"></i>
                                Última Atualização
                            </div>
                            <div class="stat-value" id="mt4LastUpdate">--:--:--</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-cogs"></i>
                                Comandos MT4
                            </div>
                        </div>
                        <div class="grid grid-3">
                            <button class="btn btn-success">
                                <i class="fas fa-play"></i>
                                Iniciar Trading
                            </button>
                            <button class="btn btn-warning">
                                <i class="fas fa-pause"></i>
                                Pausar Trading
                            </button>
                            <button class="btn btn-danger">
                                <i class="fas fa-times"></i>
                                Fechar Todas Posições
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- ========== SYSTEM SECTION ========== -->
                <section class="content-section" id="system-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-cog text-gold"></i>
                        Status do Sistema
                    </h2>
                    
                    <div class="grid grid-4 mb-3">
                        <div class="card">
                            <div class="stat-label">Uptime</div>
                            <div class="stat-value" id="systemUptime">--</div>
                        </div>
                        <div class="card">
                            <div class="stat-label">CPU</div>
                            <div class="stat-value" id="systemCpu">--</div>
                        </div>
                        <div class="card">
                            <div class="stat-label">Memória</div>
                            <div class="stat-value" id="systemMemory">--</div>
                        </div>
                        <div class="card">
                            <div class="stat-label">Estratégias Ativas</div>
                            <div class="stat-value" id="systemStrategies">--</div>
                        </div>
                    </div>
                    
                    <!-- System Logs -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-terminal"></i>
                                Logs do Servidor
                            </div>
                            <button class="btn btn-danger btn-sm" id="restartServerBtn">
                                <i class="fas fa-sync-alt"></i>
                                Reiniciar Servidor
                            </button>
                        </div>
                        <div id="systemLogs" style="height: 400px; overflow-y: auto; background: var(--accent-bg); padding: 15px; border-radius: 10px; font-family: monospace; font-size: 12px;">
                            <!-- Logs will be loaded here -->
                        </div>
                    </div>
                </section>
                
                <!-- ========== SETTINGS SECTION ========== -->
                <section class="content-section" id="settings-section">
                    <h2 class="section-title mb-3">
                        <i class="fas fa-sliders-h text-gold"></i>
                        Configurações
                    </h2>
                    
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-cog"></i>
                                Configurações Gerais
                            </div>
                        </div>
                        <div>
                            <p>Em desenvolvimento. Aqui você poderá ajustar parâmetros de risco, estratégias e conexões.</p>
                        </div>
                    </div>
                </section>
                
                <!-- Seções removidas/simplificadas: Risk, Telegram, Files -->
                <!-- Risk: Integrado no Overview e em Stats. -->
                <!-- Telegram: Simplificado para um botão de comando no MT4/System. -->
                <!-- Files: Removido por complexidade de implementação segura. -->
            </div>
        </main>
    </div>
    
    <!-- JavaScript -->
    <script src="/static/js/dashboard.js"></script>
    <script src="/static/js/dashboard-advanced.js"></script>
</body>
</html>
