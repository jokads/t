<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - JokaMazKiBu Trading Bot v6.0</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/style.css">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Canvas para efeito de triângulos de fundo -->
    <canvas id="triangle-canvas"></canvas>
    
    <div class="dashboard-container">
        <!-- ========== SIDEBAR ========== -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <img src="/static/img/logo.png" alt="Logo" class="logo-img">
                    <div class="logo-text">JOKAMAZKIBU</div>
                    <div class="version">v6.0 Ultra Advanced</div>
                </div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-item active" data-section="overview">
                    <a href="#" class="nav-link">
                        <i class="fas fa-chart-line"></i>
                        <span>Overview</span>
                        <span class="nav-badge">LIVE</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="trades">
                    <a href="#" class="nav-link">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Trades Ativos</span>
                        <span class="nav-badge" id="activeTradesCountBadge">0</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="history">
                    <a href="#" class="nav-link">
                        <i class="fas fa-history"></i>
                        <span>Histórico</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="strategies">
                    <a href="#" class="nav-link">
                        <i class="fas fa-brain"></i>
                        <span>Estratégias</span>
                        <span class="nav-badge" id="strategyCount">0</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="ai">
                    <a href="#" class="nav-link">
                        <i class="fas fa-robot"></i>
                        <span>IA & Análise</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="news">
                    <a href="#" class="nav-link">
                        <i class="fas fa-newspaper"></i>
                        <span>Notícias</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="mt4">
                    <a href="#" class="nav-link">
                        <i class="fas fa-plug"></i>
                        <span>Controlo MT4</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="logs">
                    <a href="#" class="nav-link">
                        <i class="fas fa-terminal"></i>
                        <span>Logs do Sistema</span>
                    </a>
                </div>
                
                <div class="nav-item" data-section="settings">
                    <a href="#" class="nav-link">
                        <i class="fas fa-cog"></i>
                        <span>Configurações</span>
                    </a>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span>{{ username }}</span>
                </div>
                <a href="/logout" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </a>
            </div>
        </aside>
        
        <!-- ========== MAIN CONTENT ========== -->
        <main class="main-content">
            <!-- Header -->
            <header class="content-header">
                <div class="header-left">
                    <button id="menuToggle" class="menu-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 id="pageTitle">Overview</h1>
                </div>
                
                <div class="header-right">
                    <div class="status-indicator online" id="mt4Status">
                        <span class="status-dot"></span>
                        <span>MT4 Conectado</span>
                    </div>
                    
                    <div class="status-indicator online" id="systemStatus">
                        <span class="status-dot"></span>
                        <span>Sistema Online</span>
                    </div>
                    
                    <div class="uptime-display" id="uptimeDisplay">
                        <i class="fas fa-clock"></i>
                        <span id="uptimeText">00:00:00</span>
                    </div>
                </div>
            </header>
            
            <!-- Content Area -->
            <div class="content-area" id="mainContent">
                <!-- ========== OVERVIEW SECTION ========== -->
                <section id="section-overview" class="content-section active">
                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon balance">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Saldo Total</div>
                                <div class="stat-value" id="totalBalance">$10,000.00</div>
                                <div class="stat-subtitle" id="totalEquity">Equity: $10,000.00</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon profit">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Lucro/Perda</div>
                                <div class="stat-value" id="totalProfit">$0.00</div>
                                <div class="card-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="profitTodayText">Hoje: $0.00</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon trades">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Trades Ativos</div>
                                <div class="stat-value" id="activeTradesCount">0</div>
                                <div class="stat-subtitle" id="totalTrades">Total: 0</div>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon winrate">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <div class="stat-content">
                                <div class="stat-label">Taxa de Acerto</div>
                                <div class="stat-value" id="winRate">0%</div>
                                <div class="card-change positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="totalTradesToday">0 trades hoje</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts Row -->
                    <div class="charts-row">
                        <div class="chart-card">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-area"></i> Evolução do Saldo</h3>
                                <div class="card-actions">
                                    <button class="btn-icon" title="Atualizar">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="balanceChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-card">
                            <div class="card-header">
                                <h3><i class="fas fa-brain"></i> Performance por Estratégia</h3>
                                <div class="card-actions">
                                    <button class="btn-icon" title="Atualizar">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="strategyChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="activity-card">
                        <div class="card-header">
                            <h3><i class="fas fa-clock"></i> Atividade Recente</h3>
                        </div>
                        <div class="card-body">
                            <div class="activity-list" id="recentActivity">
                                <div class="activity-item">
                                    <div class="activity-icon success">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Sistema iniciado com sucesso</div>
                                        <div class="activity-time">Agora</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== TRADES SECTION ========== -->
                <section id="section-trades" class="content-section">
                    <div class="table-card">
                        <div class="card-header">
                            <h3><i class="fas fa-exchange-alt"></i> Posições Abertas</h3>
                            <div class="card-actions">
                                <button class="btn-primary btn-sm" onclick="refreshTrades()">
                                    <i class="fas fa-sync-alt"></i> Atualizar
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Ticket</th>
                                            <th>Símbolo</th>
                                            <th>Tipo</th>
                                            <th>Volume</th>
                                            <th>Abertura</th>
                                            <th>Preço Atual</th>
                                            <th>SL</th>
                                            <th>TP</th>
                                            <th>Lucro</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="activeTradesTableBody">
                                        <tr>
                                            <td colspan="10" class="text-center">Nenhuma posição ativa.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== HISTORY SECTION ========== -->
                <section id="section-history" class="content-section">
                    <div class="table-card">
                        <div class="card-header">
                            <h3><i class="fas fa-history"></i> Histórico de Trades</h3>
                            <div class="card-actions">
                                <select id="historyFilter" class="form-select">
                                    <option value="7">Últimos 7 dias</option>
                                    <option value="30">Últimos 30 dias</option>
                                    <option value="90">Últimos 90 dias</option>
                                </select>
                                <button class="btn-primary btn-sm" onclick="refreshHistory()">
                                    <i class="fas fa-sync-alt"></i> Atualizar
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Ticket</th>
                                            <th>Símbolo</th>
                                            <th>Tipo</th>
                                            <th>Volume</th>
                                            <th>Abertura</th>
                                            <th>Fecho</th>
                                            <th>Lucro</th>
                                            <th>Data</th>
                                        </tr>
                                    </thead>
                                    <tbody id="historyTableBody">
                                        <tr>
                                            <td colspan="8" class="text-center">Nenhum histórico disponível.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== STRATEGIES SECTION ========== -->
                <section id="section-strategies" class="content-section">
                    <div class="strategies-grid" id="strategiesGrid">
                        <!-- Estratégias serão carregadas dinamicamente -->
                    </div>
                </section>
                
                <!-- ========== AI SECTION ========== -->
                <section id="section-ai" class="content-section">
                    <div class="ai-container">
                        <div class="ai-models-card">
                            <div class="card-header">
                                <h3><i class="fas fa-microchip"></i> Modelos IA Disponíveis</h3>
                            </div>
                            <div class="card-body">
                                <div class="models-list" id="aiModelsList">
                                    <!-- Modelos serão carregados dinamicamente -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="ai-chat-card">
                            <div class="card-header">
                                <h3><i class="fas fa-comments"></i> Consultar IA</h3>
                            </div>
                            <div class="card-body">
                                <div class="chat-messages" id="aiChatMessages">
                                    <div class="chat-message system">
                                        <div class="message-content">
                                            <p>Bem-vindo ao assistente IA! Faça perguntas sobre o mercado, estratégias ou análises.</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="chat-input-container">
                                    <select id="aiModelSelect" class="form-select">
                                        <option value="">Modelo Padrão</option>
                                    </select>
                                    <textarea id="aiPromptInput" placeholder="Digite sua pergunta..." rows="3"></textarea>
                                    <button id="aiSendBtn" class="btn-primary">
                                        <i class="fas fa-paper-plane"></i> Enviar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== NEWS SECTION ========== -->
                <section id="section-news" class="content-section">
                    <div class="news-card">
                        <div class="card-header">
                            <h3><i class="fas fa-newspaper"></i> Notícias do Mercado</h3>
                            <div class="card-actions">
                                <button class="btn-primary btn-sm" onclick="refreshNews()">
                                    <i class="fas fa-sync-alt"></i> Atualizar
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="news-list" id="newsList">
                                <div class="news-item">
                                    <div class="news-header">
                                        <span class="news-source">Sistema</span>
                                        <span class="news-time">Agora</span>
                                    </div>
                                    <h4 class="news-title">Aguardando notícias...</h4>
                                    <p class="news-content">O sistema está carregando as últimas notícias do mercado.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== MT4 CONTROL SECTION ========== -->
                <section id="section-mt4" class="content-section">
                    <div class="mt4-grid">
                        <div class="mt4-info-card">
                            <div class="card-header">
                                <h3><i class="fas fa-info-circle"></i> Informações da Conta MT4</h3>
                            </div>
                            <div class="card-body">
                                <div class="info-row">
                                    <span class="info-label">Margem Livre:</span>
                                    <span class="info-value" id="mt4FreeMargin">$0.00</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Nível de Margem:</span>
                                    <span class="info-value" id="mt4MarginLevel">0%</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Status Conexão:</span>
                                    <span class="info-value" id="mt4ConnectionStatus">Desconectado</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt4-control-card">
                            <div class="card-header">
                                <h3><i class="fas fa-sliders-h"></i> Controles</h3>
                            </div>
                            <div class="card-body">
                                <button class="btn-success btn-block" onclick="startBot()">
                                    <i class="fas fa-play"></i> Iniciar Bot
                                </button>
                                <button class="btn-warning btn-block" onclick="pauseBot()">
                                    <i class="fas fa-pause"></i> Pausar Bot
                                </button>
                                <button class="btn-danger btn-block" onclick="stopBot()">
                                    <i class="fas fa-stop"></i> Parar Bot
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== LOGS SECTION ========== -->
                <section id="section-logs" class="content-section">
                    <div class="logs-card">
                        <div class="card-header">
                            <h3><i class="fas fa-terminal"></i> Logs do Sistema</h3>
                            <div class="card-actions">
                                <select id="logLevelFilter" class="form-select">
                                    <option value="ALL">Todos</option>
                                    <option value="INFO">INFO</option>
                                    <option value="WARNING">WARNING</option>
                                    <option value="ERROR">ERROR</option>
                                </select>
                                <button class="btn-primary btn-sm" onclick="clearLogs()">
                                    <i class="fas fa-trash"></i> Limpar
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="logs-container" id="logsContainer">
                                <div class="log-entry info">
                                    <span class="log-time">[00:00:00]</span>
                                    <span class="log-level">INFO</span>
                                    <span class="log-message">Sistema iniciado</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- ========== SETTINGS SECTION ========== -->
                <section id="section-settings" class="content-section">
                    <div class="settings-card">
                        <div class="card-header">
                            <h3><i class="fas fa-cog"></i> Configurações</h3>
                        </div>
                        <div class="card-body">
                            <div class="settings-section">
                                <h4>Preferências de Interface</h4>
                                <div class="setting-item">
                                    <label>
                                        <input type="checkbox" id="darkModeToggle" checked>
                                        <span>Modo Escuro</span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <label>
                                        <input type="checkbox" id="soundNotifications" checked>
                                        <span>Notificações Sonoras</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <h4>Configurações de Trading</h4>
                                <div class="setting-item">
                                    <label for="defaultLotSize">Lote Padrão:</label>
                                    <input type="number" id="defaultLotSize" value="0.01" step="0.01" min="0.01">
                                </div>
                                <div class="setting-item">
                                    <label for="maxPositions">Máximo de Posições:</label>
                                    <input type="number" id="maxPositions" value="5" min="1" max="20">
                                </div>
                            </div>
                            
                            <div class="settings-actions">
                                <button class="btn-primary" onclick="saveSettings()">
                                    <i class="fas fa-save"></i> Guardar Configurações
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    
    <!-- Scripts -->
    <script src="/static/js/dashboard.js"></script>
</body>
</html>
